<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spiral Board Game - Host</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .header {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            padding: 15px;
            text-align: center;
            color: white;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }

        .room-code {
            font-size: 24px;
            font-weight: bold;
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 25px;
        }

        .game-level {
            font-size: 18px;
            background: rgba(255,255,255,0.15);
            padding: 8px 16px;
            border-radius: 20px;
        }

        .current-turn {
            font-size: 16px;
            background: rgba(255,255,255,0.15);
            padding: 8px 16px;
            border-radius: 20px;
        }

        .main-container {
            flex: 1;
            display: flex;
            position: relative;
        }

        .board-container {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .board {
            position: relative;
            width: min(80vh, 80vw);
            height: min(80vh, 80vw);
            border-radius: 50%;
            background: radial-gradient(circle, #fff 20%, #f0f0f0 100%);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .ring {
            position: absolute;
            border: 2px solid #ddd;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .center-circle {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #ff6b6b, #feca57);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .pawn {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            z-index: 10;
        }

        .pawn:hover {
            transform: scale(1.2);
            box-shadow: 0 4px 15px rgba(0,0,0,0.4);
        }

        .sidebar {
            width: 350px;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            box-shadow: -5px 0 20px rgba(0,0,0,0.1);
        }

        .players-section {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .section-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }

        .player-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .player {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(255,255,255,0.8);
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.2s ease;
        }

        .player:hover {
            transform: translateX(5px);
        }

        .player.current-turn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .player-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        .player-info {
            flex: 1;
        }

        .player-name {
            font-weight: bold;
            font-size: 14px;
        }

        .player-ring {
            font-size: 12px;
            opacity: 0.8;
        }

        .card-section {
            padding: 20px;
            border-top: 1px solid #eee;
            background: rgba(248,249,250,0.9);
        }

        .current-card {
            background: white;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 4px solid #667eea;
        }

        .card-category {
            font-size: 12px;
            text-transform: uppercase;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .card-text {
            font-size: 14px;
            line-height: 1.4;
            color: #333;
        }

        .controls {
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #333;
            border: 1px solid #ddd;
        }

        .btn-secondary:hover {
            background: #e9ecef;
        }

        .connection-status {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }

        .connected {
            background: #d4edda;
            color: #155724;
        }

        .disconnected {
            background: #f8d7da;
            color: #721c24;
        }

        @media (max-width: 1200px) {
            .sidebar {
                width: 300px;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: 40vh;
            }
            
            .board-container {
                flex: 1;
            }
        }
    </style>
</head>
<body>
    <div class="connection-status connected" id="connectionStatus">
        ðŸŸ¢ Server Connected
    </div>

    <div class="header">
        <div class="game-info">
            <div class="room-code">Room: <span id="roomCode">ABCD</span></div>
            <div class="game-level">Level: <span id="gameLevel">Basic</span></div>
            <div class="current-turn">Turn: <span id="currentPlayer">Waiting...</span></div>
        </div>
    </div>

    <div class="main-container">
        <div class="board-container">
            <div class="board" id="gameBoard">
                <div class="center-circle">GOAL</div>
                <!-- Rings will be generated by JavaScript -->
            </div>
        </div>

        <div class="sidebar">
            <div class="players-section">
                <div class="section-title">Players (<span id="playerCount">0</span>)</div>
                <div class="player-list" id="playerList">
                    <!-- Players will be added here -->
                </div>
            </div>

            <div class="card-section">
                <div class="section-title">Current Card</div>
                <div class="current-card" id="currentCard">
                    <div class="card-category">Waiting for game to start...</div>
                    <div class="card-text">Players can join using their phones by visiting the room code above.</div>
                </div>
            </div>

            <div class="controls">
                <button class="btn btn-primary" onclick="startGame()" id="startBtn">Start Game</button>
                <button class="btn btn-primary" onclick="nextTurn()" id="nextBtn" style="display:none;">Next Turn</button>
                <button class="btn btn-secondary" onclick="resetGame()">Reset Game</button>
                <select class="btn btn-secondary" id="levelSelect" onchange="changeLevel()">
                    <option value="basic">Basic Level</option>
                    <option value="intermediate">Intermediate Level</option>
                    <option value="advanced">Advanced Level</option>
                </select>
            </div>
        </div>
    </div>

    <script>
        // Game state
        let gameState = {
            players: [],
            currentPlayerIndex: 0,
            gameStarted: false,
            level: 'basic',
            currentCard: null,
            roomCode: 'ABCD'
        };

        // Pawn colors
        const pawnColors = [
            '#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7',
            '#DDA0DD', '#98D8C8', '#F7DC6F', '#BB8FCE', '#85C1E9',
            '#F8C471', '#82E0AA', '#F1948A', '#85C1E9', '#D2B4DE',
            '#AED6F1', '#A3E4D7', '#F9E79F', '#FADBD8', '#D5DBDB',
            '#FFB3BA', '#BAFFC9', '#BAE1FF', '#FFFFBA', '#FFD700',
            '#FF69B4', '#00CED1', '#9370DB', '#32CD32', '#FF4500'
        ];

        // Sample cards for demonstration
        const cardDecks = {
            privilege: [
                "Your family has a computer at home. Move forward 2 spaces.",
                "You speak the dominant language fluently. Move forward 1 space.",
                "Your parents have university degrees. Move forward 2 spaces.",
                "You have access to private tutoring. Move forward 3 spaces.",
                "Your family owns their home. Move forward 1 space."
            ],
            discrimination: [
                "You face language barriers in school. Move back 2 spaces.",
                "Your family struggles financially. Move back 1 space.",
                "You experience bullying due to differences. Move back 3 spaces.",
                "Limited access to educational resources. Move back 2 spaces.",
                "Your neighborhood lacks good schools. Move back 1 space."
            ],
            social_policy: [
                "Free school meal program launched. All players move forward 1 space.",
                "Budget cuts affect school resources. All players move back 1 space.",
                "New anti-discrimination policy implemented. Move forward 2 spaces.",
                "Scholarship program for disadvantaged students. Move forward 3 spaces.",
                "Technology access program in schools. Move forward 1 space."
            ]
        };

        // Initialize the game board
        function initializeBoard() {
            const board = document.getElementById('gameBoard');
            
            // Create 21 rings
            for (let i = 1; i <= 21; i++) {
                const ring = document.createElement('div');
                ring.className = 'ring';
                const size = 60 + (i * 15); // Increasing size for each ring
                ring.style.width = size + 'px';
                ring.style.height = size + 'px';
                ring.id = `ring-${i}`;
                board.appendChild(ring);
            }
        }

        // Add a player to the game
        function addPlayer(name, color = null) {
            if (gameState.players.length >= 30) {
                alert('Maximum 30 players allowed');
                return;
            }

            const playerColor = color || pawnColors[gameState.players.length];
            const player = {
                id: Date.now(),
                name: name,
                color: playerColor,
                ring: 21, // Start at outer ring
                position: 0
            };

            gameState.players.push(player);
            updatePlayerList();
            createPawn(player);
            return player;
        }

        // Create visual pawn on board
        function createPawn(player) {
            const pawn = document.createElement('div');
            pawn.className = 'pawn';
            pawn.id = `pawn-${player.id}`;
            pawn.style.backgroundColor = player.color;
            pawn.title = player.name;
            
            // Position pawn on outer ring
            positionPawn(pawn, 21, gameState.players.length - 1);
            
            document.getElementById('gameBoard').appendChild(pawn);
        }

        // Position pawn on specific ring
        function positionPawn(pawnElement, ring, playerIndex) {
            const board = document.getElementById('gameBoard');
            const boardRect = board.getBoundingClientRect();
            const centerX = board.offsetWidth / 2;
            const centerY = board.offsetHeight / 2;
            
            const radius = 30 + (ring * 7.5); // Radius for each ring
            const angle = (playerIndex * (360 / Math.max(gameState.players.length, 8))) * (Math.PI / 180);
            
            const x = centerX + radius * Math.cos(angle) - 10; // -10 for pawn center
            const y = centerY + radius * Math.sin(angle) - 10;
            
            pawnElement.style.left = x + 'px';
            pawnElement.style.top = y + 'px';
        }

        // Update player list display
        function updatePlayerList() {
            const playerList = document.getElementById('playerList');
            const playerCount = document.getElementById('playerCount');
            
            playerList.innerHTML = '';
            playerCount.textContent = gameState.players.length;
            
            gameState.players.forEach((player, index) => {
                const playerDiv = document.createElement('div');
                playerDiv.className = 'player';
                if (index === gameState.currentPlayerIndex && gameState.gameStarted) {
                    playerDiv.classList.add('current-turn');
                }
                
                playerDiv.innerHTML = `
                    <div class="player-color" style="background-color: ${player.color}"></div>
                    <div class="player-info">
                        <div class="player-name">${player.name}</div>
                        <div class="player-ring">Ring ${player.ring}</div>
                    </div>
                `;
                
                playerList.appendChild(playerDiv);
            });
        }

        // Draw a card based on game level
        function drawCard() {
            let availableDecks = [];
            
            switch (gameState.level) {
                case 'basic':
                    availableDecks = ['privilege', 'discrimination'];
                    break;
                case 'intermediate':
                    // Alternate between privilege/discrimination and social_policy
                    if (gameState.currentPlayerIndex % 2 === 0) {
                        availableDecks = ['privilege', 'discrimination'];
                    } else {
                        availableDecks = ['social_policy'];
                    }
                    break;
                case 'advanced':
                    availableDecks = ['privilege', 'discrimination', 'social_policy'];
                    break;
            }
            
            const deckType = availableDecks[Math.floor(Math.random() * availableDecks.length)];
            const deck = cardDecks[deckType];
            const card = deck[Math.floor(Math.random() * deck.length)];
            
            return {
                category: deckType,
                text: card
            };
        }

        // Move player based on card effect
        function movePlayer(player, spaces) {
            player.ring = Math.max(1, Math.min(21, player.ring - spaces)); // Ring 1 is center, 21 is outer
            
            const pawnElement = document.getElementById(`pawn-${player.id}`);
            const playerIndex = gameState.players.findIndex(p => p.id === player.id);
            positionPawn(pawnElement, player.ring, playerIndex);
            
            updatePlayerList();
            
            // Check for winner
            if (player.ring === 1) {
                setTimeout(() => {
                    alert(`ðŸŽ‰ ${player.name} wins! They reached the center!`);
                    resetGame();
                }, 500);
            }
        }

        // Process card effect
        function processCard(card) {
            // Simple parsing of card text to determine movement
            let spaces = 0;
            const text = card.text.toLowerCase();
            
            if (text.includes('move forward')) {
                const match = text.match(/move forward (\d+)/);
                spaces = match ? parseInt(match[1]) : 1;
            } else if (text.includes('move back')) {
                const match = text.match(/move back (\d+)/);
                spaces = match ? -parseInt(match[1]) : -1;
            }
            
            // Apply movement
            if (text.includes('all players')) {
                gameState.players.forEach(player => movePlayer(player, spaces));
            } else {
                const currentPlayer = gameState.players[gameState.currentPlayerIndex];
                movePlayer(currentPlayer, spaces);
            }
        }

        // Start the game
        function startGame() {
            if (gameState.players.length < 5) {
                alert('Need at least 5 players to start');
                return;
            }
            
            gameState.gameStarted = true;
            gameState.currentPlayerIndex = 0;
            
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'block';
            
            updateCurrentPlayer();
            nextTurn();
        }

        // Next turn
        function nextTurn() {
            if (!gameState.gameStarted) return;
            
            const card = drawCard();
            gameState.currentCard = card;
            
            // Display card
            const cardElement = document.getElementById('currentCard');
            cardElement.innerHTML = `
                <div class="card-category">${card.category.toUpperCase()}</div>
                <div class="card-text">${card.text}</div>
            `;
            
            // Process card effect
            processCard(card);
            
            // Move to next player
            gameState.currentPlayerIndex = (gameState.currentPlayerIndex + 1) % gameState.players.length;
            updateCurrentPlayer();
        }

        // Update current player display
        function updateCurrentPlayer() {
            const currentPlayer = gameState.players[gameState.currentPlayerIndex];
            document.getElementById('currentPlayer').textContent = currentPlayer ? currentPlayer.name : 'Waiting...';
            updatePlayerList();
        }

        // Change game level
        function changeLevel() {
            const level = document.getElementById('levelSelect').value;
            gameState.level = level;
            document.getElementById('gameLevel').textContent = level.charAt(0).toUpperCase() + level.slice(1);
        }

        // Reset game
        function resetGame() {
            gameState.gameStarted = false;
            gameState.currentPlayerIndex = 0;
            gameState.players.forEach(player => {
                player.ring = 21;
                const pawnElement = document.getElementById(`pawn-${player.id}`);
                const playerIndex = gameState.players.findIndex(p => p.id === player.id);
                positionPawn(pawnElement, 21, playerIndex);
            });
            
            updatePlayerList();
            
            document.getElementById('startBtn').style.display = 'block';
            document.getElementById('nextBtn').style.display = 'none';
            document.getElementById('currentCard').innerHTML = `
                <div class="card-category">Game Reset</div>
                <div class="card-text">Ready to start a new game!</div>
            `;
        }

        // Demo: Add some players for testing
        function addDemoPlayers() {
            const demoNames = ['Alice', 'Bob', 'Charlie', 'Diana', 'Eve', 'Frank', 'Grace', 'Henry'];
            demoNames.forEach(name => addPlayer(name));
        }

        // Initialize the game
        document.addEventListener('DOMContentLoaded', function() {
            initializeBoard();
            // Add demo players for testing
            addDemoPlayers();
        });

        // Simple WebSocket simulation (in real implementation, this would connect to your server)
        function simulateWebSocket() {
            // This is where you would implement Socket.io connection
            console.log('WebSocket connection would be established here');
        }

        simulateWebSocket();
    </script>
</body>
</html>